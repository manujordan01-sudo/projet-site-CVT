<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoConfiance ‚Äì Vente de voitures</title>

    <meta name="description" content="Plateforme de vente de voitures en C√¥te d'Ivoire ‚Äî annonces v√©rifi√©es, filtres en temps r√©el, mode sombre et interface mobile optimis√©e.">
    <meta name="keywords" content="voiture occasion CI, vente voiture Abidjan, SUV, berline, 4x4, filtre voiture, dark mode">
    <link rel="shortcut icon" href="img log.png" type="favicon/png">

    <!-- Styles concentr√©s (extracted to styles.css) -->
    <link rel="stylesheet" href="styles.css">

  </head>
  <body>

    <header>
      <div class="container topbar">
        <div class="brand">
          <svg width="44" height="44" viewBox="0 0 24 24" fill="none" aria-hidden>
            <rect width="24" height="24" rx="6" fill="#fff" opacity="0.06"></rect>
            <path d="M4 13c0-4 3-7 7-7s7 3 7 7v3H4v-3z" fill="#fff" opacity="0.9"></path>
          </svg>
          <div>
            <h1>AutoConfiance</h1>
            <div style="font-size:12px;color:rgba(255,255,255,0.9)">Voitures neuves & d'occasion ‚Ä¢ C√¥te d'Ivoire</div>
          </div>
        </div>

        <div class="controls">
          <nav class="nav">
            <a href="#accueil">accueil</a>
            <a href="#catalogue">Catalogue</a>
            <a href="#services">Services</a>
            <a href="#contact">Contact</a>
          </nav>

          <button id="toggleDark" class="btn" aria-pressed="false"
          
          title="Activer mode sombre">üåô</button>
        </div>
      </div>
    </header>

    <main class="container hero">
      <div>
        <h2>Trouvez la voiture qui vous ressemble</h2>
        <p>Annonces v√©rifi√©es, recherche instantan√©e et filtre en temps r√©el pour une exp√©rience fluide sur mobile et desktop.</p>

        <div class="features">
          <div class="feature animate">
            <strong>V√©rifi√©</strong>
            <div style="margin-top:8px;color:var(--muted)">Contr√¥le technique et historique complet.</div>
          </div>
          <div class="feature animate" style="animation-delay:.06s">
            <strong>Financement</strong>
            <div style="margin-top:8px;color:var(--muted)">Offres adapt√©es et rapides.</div>
          </div>
          <div class="feature animate" style="animation-delay:.12s">
            <strong>Livraison</strong>
            <div style="margin-top:8px;color:var(--muted)">Livraison possible √† Abidjan.</div>
          </div>
        </div>

        <!-- Filters visibles sur desktop (mobile collapsible) -->
        <div class="filters" role="region" aria-label="Filtres rapides">
          <div class="chip">Filtre : <strong id="activeFilters">Tous</strong></div>
          <div style="flex:1"></div>
        </div>

        <!-- Catalogue -->
        <section id="catalog">
          <h3>Nos derni√®res annonces</h3>

          <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap;align-items:center">
            <input id="q" type="search" placeholder="Rechercher mod√®le, marque..." aria-label="Recherche" style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)">

            <select id="type" aria-label="Type" style="padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)">
              <option value="">Tous types</option>
              <option value="Berline">Berline</option>
              <option value="SUV">SUV</option>
              <option value="4x4">4x4</option>
            </select>

            <select id="budget" aria-label="Budget" style="padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)">
              <option value="">Tous budgets</option>
              <option value='{"max":3000000}'>Moins de 3 000 000 XOF</option>
              <option value='{"min":3000000,"max":6000000}'>3 000 000 - 6 000 000 XOF</option>
              <option value='{"min":6000000}'>Plus de 6 000 000 XOF</option>
            </select>

            <button id="clearFilters" class="primary" style="white-space:nowrap">R√©initialiser</button>
          </div>

          <div class="grid" id="listings" aria-live="polite">

            <!-- Exemple de carte avec data-attributes pour filtrage -->
            <article class="card animate" data-model="toyota corolla" data-type="Berline" data-price="3800000">
              <img loading="lazy" src="toyo.png" alt="Toyota Corolla 2018">
              <div class="card-body">
                <div class="car-title">Toyota Corolla 2018</div>
                <div class="meta">Abidjan ‚Ä¢ 120 000 km ‚Ä¢ Essence ‚Ä¢ Manuelle</div>
                <div class="price">3 800 000 XOF</div>
              </div>
            </article>

            <article class="card animate" data-model="renault duster" data-type="4x4" data-price="4250000">
              <img loading="lazy" src="dester.jpg" alt="Renault Duster 2017">
              <div class="card-body">
                <div class="car-title">Renault Duster 2017</div>
                <div class="meta">Abidjan ‚Ä¢ 95 000 km ‚Ä¢ Diesel ‚Ä¢ 4x4</div>
                <div class="price">4 250 000 XOF</div>
              </div>
            </article>

            <article class="card animate" data-model="mercedes classe c" data-type="Berline" data-price="9500000">
              <img loading="lazy" src="merco.jpg" alt="Mercedes Classe C 2016">
              <div class="card-body">
                <div class="car-title">Mercedes Classe C 2016</div>
                <div class="meta">Abidjan ‚Ä¢ 75 000 km ‚Ä¢ Essence ‚Ä¢ Automatique</div>
                <div class="price">9 500 000 XOF</div>
              </div>
            </article>

            <!-- Ajoutez d'autres annonces ici avec les m√™mes data-attributes -->

          </div>
        </section>

      </div>

      <!-- Sidebar / Search card -->
      <aside>
        <div class="search-card">
          <h4>Filtres avanc√©s</h4>
          <p style="color:var(--muted);margin-top:4px">Affinez en temps r√©el</p>

          <div style="margin-top:12px;display:flex;gap:8px;flex-direction:column">
            <label class="visually-hidden" for="qSidebar">Recherche</label>
            <input id="qSidebar" placeholder="Marque, mod√®le, ann√©e..." />

            <label class="visually-hidden" for="minKm">Kilom√©trage max</label>
            <input id="minKm" placeholder="Kilom√©trage max" />

            <label class="visually-hidden" for="fuel">Carburant</label>
            <select id="fuel">
              <option value="">Tous carburants</option>
              <option value="Essence">Essence</option>
              <option value="Diesel">Diesel</option>
            </select>

            <div style="display:flex;gap:8px">
              <button id="applyFilters" class="primary" style="flex:1">Appliquer</button>
              <button id="toggleMap" class="btn ghost" style="flex:0">Carte</button>
            </div>
          </div>

        </div>

        <div style="margin-top:16px;background:var(--card);padding:12px;border-radius:12px;box-shadow:var(--shadow)">
          <h4>Vendre votre voiture</h4>
          <p style="color:var(--muted)">D√©posez une annonce en quelques √©tapes.</p>
          <a href="#" class="primary" style="display:inline-block;margin-top:10px;text-decoration:none">D√©poser une annonce</a>
        </div>
      </aside>
    </main>

    <main class="container">
      <section id="services" style="margin-top:28px">
        <h3>Nos services</h3>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:12px">
          <div style="background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);flex:1;min-width:220px">
            <strong>Inspection compl√®te</strong>
            <div style="margin-top:8px;color:var(--muted)">Rapport d√©taill√© et photos.</div>
          </div>

          <div style="background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);flex:1;min-width:220px">
            <strong>Financement & assurance</strong>
            <div style="margin-top:8px;color:var(--muted)">Solutions adapt√©es.</div>
          </div>

          <div style="background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);flex:1;min-width:220px">
            <strong>Reprise & estimation</strong>
            <div style="margin-top:8px;color:var(--muted)">√âvaluation rapide.</div>
          </div>
        </div>
      </section>

      <section id="contact" style="margin-top:24px">
        <h3>Contact</h3>
        <div style="display:grid;grid-template-columns:1fr 320px;gap:18px;margin-top:12px">
          <div style="background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow)">
            <form id="contactForm">
              <label>Nom et pr√©nom</label>
              <input type="text" required />

              
              <label>Email</label>
              <input type="email" required />

              
              <label>Message</label>
              <textarea rows="4" required></textarea>

              
              <button class="primary" type="submit">Envoyer</button>
            </form>
          </div>

          <aside style="background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow)">

            <strong>Infos</strong>
            
            <div style="margin-top:8px;color:var(--muted)">
              Adresse : Abidjan, Cocody, Angr√©<br>
              T√©l√©phone : +225 01 04 42 70 06<br>
              Email : scootmanu8@gmail.com
            </div>

          </aside>
        </div>
      </section>
    </main>

    <footer style="margin-top:28px">
      <div class="container" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
        <div>&copy; <strong>AutoConfiance</strong> ‚Äî Tous droits r√©serv√©s</div>
        <div style="color:var(--muted)">Mentions l√©gales ‚Ä¢ Politique de confidentialit√©</div>
      </div>
    </footer>

    <!-- Scripts: filtrage instantan√©, dark mode, accessibility -->
    <script>
      // Dark mode toggle + persist
      const toggle = document.getElementById('toggleDark');
      const body = document.body;
      const saved = localStorage.getItem('ac_dark');
      if(saved === '1') body.classList.add('dark');
      toggle.addEventListener('click', ()=>{
        const isDark = body.classList.toggle('dark');
        toggle.setAttribute('aria-pressed', String(isDark));
        localStorage.setItem('ac_dark', isDark ? '1' : '0');
      });

      // Live filtering
      const q = document.getElementById('q');
      const type = document.getElementById('type');
      const budget = document.getElementById('budget');
      const listings = document.getElementById('listings');
      const cards = [...listings.querySelectorAll('.card')];
      const activeFilters = document.getElementById('activeFilters');

      function parseBudgetValue(optionValue){
        // Some selects may contain JSON-like strings; try parse
        try{ return JSON.parse(optionValue); }catch(e){ return null }
      }

      function matchesCard(card){
        const text = (card.dataset.model || '').toLowerCase();
        const qVal = (q.value || '').trim().toLowerCase();
        if(qVal && !text.includes(qVal)) return false;
        const typeVal = type.value;
        if(typeVal && (card.dataset.type !== typeVal)) return false;
        const budgetVal = budget.value;
        if(budgetVal){
          const b = parseBudgetValue(budgetVal);
          const price = Number(card.dataset.price || 0);
          if(b){
            if(b.min && price < b.min) return false;
            if(b.max && price > b.max) return false;
          }
        }
        return true;
      }

      function applyFilter(){
        let anyVisible = 0;
        cards.forEach(card=>{
          if(matchesCard(card)){
            card.classList.remove('hidden');
            card.style.display = '';
            anyVisible++;
          } else {
            card.classList.add('hidden');
            card.style.display = 'none';
          }
        });
        const active = [];
        if(q.value) active.push('Recherche');
        if(type.value) active.push(type.value);
        if(budget.value) active.push('Budget');
        activeFilters.textContent = active.length ? active.join(' ‚Ä¢ ') : 'Tous';
      }

      // Debounce helper for input
      function debounce(fn, wait=200){ let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn.apply(this,args), wait) } }
      const debounced = debounce(applyFilter, 180);
      [q,type,budget].forEach(el=>el.addEventListener('input', debounced));

      // Sidebar inputs
      document.getElementById('qSidebar').addEventListener('input', (e)=>{ q.value = e.target.value; debounced(); });
      document.getElementById('applyFilters').addEventListener('click', ()=>{ q.value = document.getElementById('qSidebar').value || q.value; applyFilter(); });
      document.getElementById('clearFilters').addEventListener('click', ()=>{ q.value=''; type.value=''; budget.value=''; document.getElementById('qSidebar').value=''; applyFilter(); });

      // Contact form simple handler
      document.getElementById('contactForm').addEventListener('submit', (e)=>{ e.preventDefault(); alert('Merci ‚Äî nous avons bien re√ßu votre message.'); e.target.reset(); });

      // Initial filter apply
      applyFilter();

      // Small progressive enhancement: animate appearance
      document.addEventListener('DOMContentLoaded', ()=>{ document.querySelectorAll('.animate').forEach((el,i)=>{ el.style.animationDelay = (i*60)+'ms' }) });

      
    </script>
      <!-- Assistant vendeur IA -->
    <div id="ai-button">üõçÔ∏è</div>
    <div id="ai-chat">
        <div id="ai-header">Assistant Vendeur</div>
        <div id="ai-messages"></div>
        <div id="ai-input-area">
            <input id="ai-input" type="text" placeholder="Posez votre question sur les voitures..." />
            <button id="ai-send">‚û§</button>
        </div>
    </div>

    <script>
        document.getElementById("ai-button").onclick = () => {
            const chat = document.getElementById("ai-chat");
            chat.style.display = chat.style.display === "flex" ? "none" : "flex";
        };

        async function sendMessageToAI(message) {
          // Determine API base: prefer explicit client override, otherwise
          // when opened via file:// use localhost backend so fetch resolves correctly.
          const API_BASE = window.AI_API_BASE || (location.protocol === 'file:' ? 'http://localhost:5000' : '');
          // Call backend proxy which secures the API key server-side.
          try {
            const headers = { 'Content-Type': 'application/json' };
            // send client-side proxy token if configured for testing
            if (window.AI_CLIENT_TOKEN) headers['x-ai-key'] = window.AI_CLIENT_TOKEN;

            const r = await fetch(`${API_BASE}/api/ai/chat`, {
              method: 'POST',
              headers,
              body: JSON.stringify({ message })
            });

            if (!r.ok) {
              const txt = await r.text();
              return `Erreur serveur: ${r.status} ${txt}`;
            }

            const data = await r.json();
            if (data.demo) return data.reply;
            return data.reply || 'Pas de r√©ponse disponible.';
          } catch (err) {
            return `Erreur r√©seau: ${err.message}`;
          }
        }

        document.getElementById("ai-send").onclick = async () => {
          const input = document.getElementById("ai-input");
          const text = input.value.trim();
          if (!text) return;

          addMessage(text, "ai-user");
          input.value = "";

          // show temporary typing indicator
          const typingId = `typing-${Date.now()}`;
          const typingEl = document.createElement('div');
          typingEl.id = typingId;
          typingEl.className = 'ai-message ai-bot ai-typing';
          typingEl.textContent = 'En train de r√©pondre...';
          document.getElementById('ai-messages').appendChild(typingEl);
          scrollAiMessages();

          const reply = await sendMessageToAI(text);

          // remove typing indicator and add real reply
          const tEl = document.getElementById(typingId);
          if (tEl) tEl.remove();
          addMessage(reply, 'ai-bot');
        };

        function scrollAiMessages() {
          const box = document.getElementById('ai-messages');
          if (!box) return;
          box.scrollTop = box.scrollHeight;
        }

        function addMessage(text, type) {
          const msg = document.createElement("div");
          msg.className = `ai-message ${type}`;
          msg.textContent = text;
          document.getElementById("ai-messages").appendChild(msg);
          // ensure newest message is visible
          setTimeout(()=>{ const box = document.getElementById('ai-messages'); if(box) box.scrollTop = box.scrollHeight; }, 0);
        }
      </script>

    </html>
